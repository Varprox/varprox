
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Introduction. &#8212; varprox 1.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-rendered-html.css?v=1277b6f3" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=f2a433a1"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'intro';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Example gallery" href="auto_examples/index.html" />
    <link rel="prev" title="Welcome to varprox’s documentation!" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">varprox 1.0 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="#">
    Introduction.
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="auto_examples/index.html">
    Example gallery
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="api.html">
    API reference.
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="biblio.html">
    References
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="#">
    Introduction.
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="auto_examples/index.html">
    Example gallery
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="api.html">
    API reference.
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="biblio.html">
    References
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"></div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Introduction.</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="introduction">
<h1>Introduction.<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h1>
<section id="problem-statement">
<h2>Problem statement.<a class="headerlink" href="#problem-statement" title="Link to this heading">#</a></h2>
<p>A Separable Nonlinear Least Square criterion (SNLS) is of the form</p>
<div class="math notranslate nohighlight" id="equation-criterion">
<span class="eqno">(1)<a class="headerlink" href="#equation-criterion" title="Link to this equation">#</a></span>\[h(x, y) = \frac{1}{2} \sum_{n=1}^N (F_n(x) y - w_n)^2,\]</div>
<p>where</p>
<blockquote>
<div><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> stand for two vectors in
<span class="math notranslate nohighlight">\(\mathbb{R}^K\)</span> and <span class="math notranslate nohighlight">\(\mathbb{R}^J\)</span>, respectively,</p></li>
<li><p><span class="math notranslate nohighlight">\(w_n\)</span> are some real data,</p></li>
<li><p><span class="math notranslate nohighlight">\(F_n\)</span> is a function mapping <span class="math notranslate nohighlight">\(\mathbb{R}^K\)</span>
into <span class="math notranslate nohighlight">\(\mathbb{R}^J\)</span>.</p></li>
</ul>
</div></blockquote>
<p>This package deals with the minimization over <span class="math notranslate nohighlight">\((x, y)\)</span>
of a penalized SNLS criterion</p>
<div class="math notranslate nohighlight" id="equation-pcriterion">
<span class="eqno">(2)<a class="headerlink" href="#equation-pcriterion" title="Link to this equation">#</a></span>\[p(x, y) = h(x, y)
    + \lambda_1 \: r_1(x) + \lambda_2 \: r_2(y),\]</div>
<p>where <span class="math notranslate nohighlight">\(r_1\)</span> and <span class="math notranslate nohighlight">\(r_2\)</span> are some penalization terms (potentially
non-smooth) weighted by two positive scalars <span class="math notranslate nohighlight">\(\lambda_1\)</span>
and <span class="math notranslate nohighlight">\(\lambda_2\)</span>, respectively.</p>
<p>Denoting the residuals by</p>
<div class="math notranslate nohighlight" id="equation-residuals">
<span class="eqno">(3)<a class="headerlink" href="#equation-residuals" title="Link to this equation">#</a></span>\[\epsilon_n(x, y) = F_n(x) y - w_n.\]</div>
<p>the criterion can also be written as</p>
<div class="math notranslate nohighlight" id="equation-criterion2">
<span class="eqno">(4)<a class="headerlink" href="#equation-criterion2" title="Link to this equation">#</a></span>\[h(x, y) = \frac{1}{2} \sum_{n=1}^N (\epsilon_n(x, y))^2
 + \lambda_1 \: r_1(x) + \lambda_2 \: r_2(y).\]</div>
<p>In a complete matrix form, it can further be written as</p>
<div class="math notranslate nohighlight" id="equation-criterion3">
<span class="eqno">(5)<a class="headerlink" href="#equation-criterion3" title="Link to this equation">#</a></span>\[h(x, y) = \frac{1}{2} \vert \epsilon(x, y) \vert^2
 + \lambda_1 \: r_1(x) + \lambda_2 \: r_2(y).\]</div>
<p>where <span class="math notranslate nohighlight">\(\vert \cdot \vert\)</span> is the Euclidean norm in <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span>
and <span class="math notranslate nohighlight">\(\epsilon(x, y)\)</span> is the vector formed by terms
<span class="math notranslate nohighlight">\(\epsilon_n(x, y)\)</span>.</p>
</section>
<section id="model-fitting">
<h2>Model fitting<a class="headerlink" href="#model-fitting" title="Link to this heading">#</a></h2>
<p>The NSLS problem may arise when the data is to be fitted by a model mixing linear and non linear parts. For instance, consider a situation where the data <span class="math notranslate nohighlight">\(w = (w_n)_{n=1}^N\)</span> comes from the observation of a unidimensional signal at some time points <span class="math notranslate nohighlight">\((t_n)_{n=1}^N\)</span> of <span class="math notranslate nohighlight">\(\mathbb{R}\)</span>. Assume that the data observation can be described by an additive model</p>
<div class="math notranslate nohighlight">
\[w_n = f(t_n; x, y) + \epsilon_n,\]</div>
<p>where variables <span class="math notranslate nohighlight">\(\epsilon_n\)</span> stand for independent Gaussian noise and the function <span class="math notranslate nohighlight">\(f\)</span> for a signal model depending on parameters <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>. Further assume that the model <span class="math notranslate nohighlight">\(f\)</span> is of the form</p>
<div class="math notranslate nohighlight">
\[f(t) = \sum_{j=1}^J y_j \varphi_j(t; x)\]</div>
<p>for some function <span class="math notranslate nohighlight">\(\varphi_j(\cdot; x)\)</span> depending on parameters <span class="math notranslate nohighlight">\(x\)</span>. Then, fitting the observed data <span class="math notranslate nohighlight">\(w\)</span> with the model <span class="math notranslate nohighlight">\(f\)</span> can be done by minimizing a SNLS of the form <a class="reference internal" href="#equation-criterion">(1)</a> for</p>
<div class="math notranslate nohighlight">
\[F_n(x)_j = \varphi_j(t_n; x), j=1,\cdots,J.\]</div>
<p>Such a modeling is generic and occurs in many fields of mathematical engineering. In the gallery of examples, we present some of its applications to the statistical inference of parameters for stochastic processes.</p>
</section>
<section id="variable-projection-method">
<h2>Variable projection method<a class="headerlink" href="#variable-projection-method" title="Link to this heading">#</a></h2>
<p>When there is no penalization (<span class="math notranslate nohighlight">\(\lambda_1 = \lambda_2 = 0\)</span>), the optimization problem
amounts to minimizing over <span class="math notranslate nohighlight">\(y\)</span> the function</p>
<div class="math notranslate nohighlight" id="equation-criterionb">
<span class="eqno">(6)<a class="headerlink" href="#equation-criterionb" title="Link to this equation">#</a></span>\[g(x) = h(x, y^\ast(x))\]</div>
<p>where <span class="math notranslate nohighlight">\(x^{\ast}(y)\)</span> given by</p>
<div class="math notranslate nohighlight" id="equation-varpro">
<span class="eqno">(7)<a class="headerlink" href="#equation-varpro" title="Link to this equation">#</a></span>\[y^{\ast}(x) \in \arg \min_{y} h(x, y).\]</div>
<p>This is the so-called variable projection methode which was introduced in <span id="id1">[<a class="reference internal" href="biblio.html#id4" title="H.G. Golub and V. Pereyra. The differentiation of pseudo-inverses and nonlinear least squares problems whose variables separate. SIAM Journal on Numerical Analysis, 10(2):413–432, April 1973. doi:10.1137/0710036.">3</a>]</span> to reduce the minimization problem to the single variable <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p>This package includes an extension of the variable projection to deal with cases when there are penalization and constraints on <span class="math notranslate nohighlight">\(x\)</span>. The implemented methods are precisely described in <span id="id2">[<a class="reference internal" href="biblio.html#id2" title="P. Escande and F. Richard. Full inference for the anisotropic fractional Brownian field. Journal of Probability Theory and Mathematical Statistics, 110:13-29, 2024. doi:10.1090/tpms/1204.">1</a>]</span> and <span id="id3">[<a class="reference internal" href="biblio.html#id3" title="A. Marmin and F. Richard. Varprox: a primal-dual variable projection method for the minimization of penalized separable non-linear least squares. Inverse Problems, 2025. doi:10.1088/1361-6420/ae0e48.">2</a>]</span>. It is based on a proximal dual approach, called varprox !</p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Welcome to varprox’s documentation!</p>
      </div>
    </a>
    <a class="right-next"
       href="auto_examples/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Example gallery</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-statement">Problem statement.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-fitting">Model fitting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#variable-projection-method">Variable projection method</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/intro.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, Arthur Marmin and Frédéric Richard.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>